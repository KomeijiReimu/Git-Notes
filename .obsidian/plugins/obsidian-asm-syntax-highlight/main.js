/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MultiAsmPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var MultiAsmPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.layoutReady = () => {
      console.log("Layout ready, setting up syntax highlighting");
      this.app.workspace.off("layout-ready", this.layoutReady);
      if (typeof CodeMirror !== "undefined" && CodeMirror.defineSimpleMode) {
        console.log("CodeMirror is defined, setting up syntax highlighting");
        this.defineAsmMode();
        this.refresh();
      } else {
        const setupInterval = setInterval(() => {
          if (typeof CodeMirror !== "undefined" && CodeMirror.defineSimpleMode) {
            console.log("CodeMirror is defined, setting up syntax highlighting");
            this.defineAsmMode();
            this.refresh();
            this.app.workspace.activeLeaf.rebuildView();
            clearInterval(setupInterval);
            this.pollInterval = setupInterval;
          }
        }, 100);
      }
    };
  }
  async onload() {
    console.log("Plugin loaded, waiting for layout to be ready");
    this.app.workspace.layoutReady ? this.layoutReady() : this.app.workspace.on("layout-ready", this.layoutReady);
  }
defineAsmMode() {
    const asmMode = {
      start: [
        { regex: /;.*/, token: "comment" },
        { regex: /\b(?:mov|add|sub|imul|idiv|mul|div|and|or|xor|not|neg|inc|dec|cmp|test|jmp|je|jne|jz|jnz|jg|jl|jge|jle|call|ret|push|pop|leave|lea|nop|int|syscall|cld|std|rep|repe|repne)\b/i, token: "keyword" },
        { regex: /\b(?:rax|rbx|rcx|rdx|rsi|rdi|rsp|rbp|eax|ebx|ecx|edx|esi|edi|esp|ebp|ax|bx|cx|dx|si|di|sp|bp|al|bl|cl|dl|ah|bh|ch|dh|r8|r9|r1[0-5]|r8d|r9d|r1[0-5]d|r8w|r9w|r1[0-5]w|r8b|r9b|r1[0-5]b)\b/i, token: "register" },
        { regex: /\b(?:byte|word|dword|qword|tword|ptr)?\s*\[.*?\]/i, token: "memory" },
        { regex: /\b[A-Z_][A-Z0-9_]*\b/, token: "constant" },
        { regex: /\.(?:text|data|bss|rodata|section|globl|extern|align|org|type|size|endp|proc|code|stack|model|assume|db|dw|dd|dq|dt|equ|define|segment|ends|include)/i, token: "directive" },
        { regex: /,/, token: "separator" },
        { regex: /^\s*[a-zA-Z_][a-zA-Z0-9_]*:/, token: "label" },
        { regex: /\b(?:0x[0-9A-Fa-f]+|(?:0[0-9A-Fa-f]*|[1-9][0-9A-Fa-f]*)h)\b/i, token: "hexadecimal" },
        { regex: /^\-?\d[\d_]*(?:\.\d[\d_]*)?(?:[Ee]\-?\d[\d_]*)?/, token: "decimal" }
      ]
    };
    CodeMirror.defineSimpleMode("asm", asmMode);
    CodeMirror.defineSimpleMode("nasm", asmMode); // 支持nasm
  }
  onunload() {
    if (CodeMirror.modes.hasOwnProperty("asm")) {
      delete CodeMirror.modes["asm"];
    }
    if (CodeMirror.modes.hasOwnProperty("nasm")) {
      delete CodeMirror.modes["nasm"];
    }
    this.refresh();
  }
  onunload() {
    if (CodeMirror.modes.hasOwnProperty("asm")) {
      delete CodeMirror.modes["asm"];
    }
    this.refresh();
  }
  refresh() {
    console.log("Refreshing syntax highlighting");
    this.app.workspace.iterateCodeMirrors((cm) => {
      cm.setOption("mode", cm.getOption("mode"));
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNdWx0aUFzbVBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAvLyB3YWl0IGZvciBsYXlvdXQgdG8gYmUgcmVhZHkgdG8gcGVyZm9ybSB0aGUgcmVzdFxuICAgIGNvbnNvbGUubG9nKFwiUGx1Z2luIGxvYWRlZCwgd2FpdGluZyBmb3IgbGF5b3V0IHRvIGJlIHJlYWR5XCIpO1xuICAgIHRoaXMuYXBwLndvcmtzcGFjZS5sYXlvdXRSZWFkeSA/IHRoaXMubGF5b3V0UmVhZHkoKSA6IHRoaXMuYXBwLndvcmtzcGFjZS5vbignbGF5b3V0LXJlYWR5JywgdGhpcy5sYXlvdXRSZWFkeSk7XG4gIH1cblxuICBsYXlvdXRSZWFkeSA9ICgpID0+IHtcbiAgICAvLyBkb24ndCBuZWVkIHRoZSBldmVudCBoYW5kbGVyIGFueW1vcmUsIGdldCByaWQgb2YgaXRcbiAgICBjb25zb2xlLmxvZyhcIkxheW91dCByZWFkeSwgc2V0dGluZyB1cCBzeW50YXggaGlnaGxpZ2h0aW5nXCIpO1xuICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vZmYoJ2xheW91dC1yZWFkeScsIHRoaXMubGF5b3V0UmVhZHkpO1xuICAgIGlmICh0eXBlb2YgQ29kZU1pcnJvciAhPT0gJ3VuZGVmaW5lZCcgJiYgQ29kZU1pcnJvci5kZWZpbmVTaW1wbGVNb2RlKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkNvZGVNaXJyb3IgaXMgZGVmaW5lZCwgc2V0dGluZyB1cCBzeW50YXggaGlnaGxpZ2h0aW5nXCIpO1xuICAgICAgdGhpcy5kZWZpbmVBc21Nb2RlKCk7XG4gICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgc2V0dXBJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgaWYgKHR5cGVvZiBDb2RlTWlycm9yICE9PSAndW5kZWZpbmVkJyAmJiBDb2RlTWlycm9yLmRlZmluZVNpbXBsZU1vZGUpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIkNvZGVNaXJyb3IgaXMgZGVmaW5lZCwgc2V0dGluZyB1cCBzeW50YXggaGlnaGxpZ2h0aW5nXCIpO1xuICAgICAgICAgIHRoaXMuZGVmaW5lQXNtTW9kZSgpO1xuICAgICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVMZWFmLnJlYnVpbGRWaWV3KCk7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbChzZXR1cEludGVydmFsKTtcbiAgICAgICAgICB0aGlzLnBvbGxJbnRlcnZhbCA9IHNldHVwSW50ZXJ2YWw7XG4gICAgICAgIH1cbiAgICAgIH0sIDEwMCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBkZWZpbmVBc21Nb2RlKCkge1xuICAgIGNvbnN0IGFzbU1vZGUgPSB7XG4gICAgICBzdGFydDogW1xuICAgICAgICB7IHJlZ2V4OiAvOy4qLywgdG9rZW46IFwiY29tbWVudFwiIH0sXG4gICAgICAgIHsgcmVnZXg6IC9cXGIoPzptb3Z8YWRkfHN1YnxpbXVsfGlkaXZ8bXVsfGRpdnxhbmR8b3J8eG9yfG5vdHxuZWd8aW5jfGRlY3xjbXB8dGVzdHxqbXB8amV8am5lfGp6fGpuenxqZ3xqbHxqZ2V8amxlfGNhbGx8cmV0fHB1c2h8cG9wfGxlYXZlfGxlYXxub3B8aW50fHN5c2NhbGx8Y2xkfHN0ZHxyZXB8cmVwZXxyZXBuZSlcXGIvaSwgdG9rZW46IFwia2V5d29yZFwiIH0sXG4gICAgICAgIHsgcmVnZXg6IC9cXGIoPzpyYXh8cmJ4fHJjeHxyZHh8cnNpfHJkaXxyc3B8cmJwfGVheHxlYnh8ZWN4fGVkeHxlc2l8ZWRpfGVzcHxlYnB8YXh8Ynh8Y3h8ZHh8c2l8ZGl8c3B8YnB8YWx8Ymx8Y2x8ZGx8YWh8Ymh8Y2h8ZGh8cjh8cjl8cjFbMC01XXxyOGR8cjlkfHIxWzAtNV1kfHI4d3xyOXd8cjFbMC01XXd8cjhifHI5YnxyMVswLTVdYilcXGIvaSwgdG9rZW46IFwicmVnaXN0ZXJcIiB9LFxuICAgICAgICB7IHJlZ2V4OiAvXFxiKD86Ynl0ZXx3b3JkfGR3b3JkfHF3b3JkfHR3b3JkfHB0cik/XFxzKlxcWy4qP1xcXS9pLCB0b2tlbjogXCJtZW1vcnlcIiB9LFxuICAgICAgICB7IHJlZ2V4OiAvXFxiW0EtWl9dW0EtWjAtOV9dKlxcYi8sIHRva2VuOiBcImNvbnN0YW50XCIgfSxcbiAgICAgICAgeyByZWdleDogL1xcLig/OnRleHR8ZGF0YXxic3N8cm9kYXRhfHNlY3Rpb258Z2xvYmx8ZXh0ZXJufGFsaWdufG9yZ3x0eXBlfHNpemV8ZW5kcHxwcm9jfGNvZGV8c3RhY2t8bW9kZWx8YXNzdW1lfGRifGR3fGRkfGRxfGR0fGVxdXxkZWZpbmV8c2VnbWVudHxlbmRzfGluY2x1ZGUpL2ksIHRva2VuOiBcImRpcmVjdGl2ZVwiIH0sXG4gICAgICAgIHsgcmVnZXg6IC8sLywgdG9rZW46IFwic2VwYXJhdG9yXCIgfSxcbiAgICAgICAgeyByZWdleDogL15cXHMqW2EtekEtWl9dW2EtekEtWjAtOV9dKjovLCB0b2tlbjogXCJsYWJlbFwiIH0sXG4gICAgICAgIHsgcmVnZXg6IC9cXGIoPzoweFswLTlBLUZhLWZdK3woPzowWzAtOUEtRmEtZl0qfFsxLTldWzAtOUEtRmEtZl0qKWgpXFxiL2ksIHRva2VuOiBcImhleGFkZWNpbWFsXCIgfSxcbiAgICAgICAgeyByZWdleDogL15cXC0/XFxkW1xcZF9dKig/OlxcLlxcZFtcXGRfXSopPyg/OltFZV1cXC0/XFxkW1xcZF9dKik/LywgdG9rZW46IFwiZGVjaW1hbFwiIH0sXG4gICAgICBdXG4gICAgfTtcblxuICAgIENvZGVNaXJyb3IuZGVmaW5lU2ltcGxlTW9kZSgnYXNtJywgYXNtTW9kZSk7XG4gIH1cblxuICBvbnVubG9hZCgpIHtcbiAgICBpZiAoQ29kZU1pcnJvci5tb2Rlcy5oYXNPd25Qcm9wZXJ0eShcImFzbVwiKSkge1xuICAgICAgZGVsZXRlIENvZGVNaXJyb3IubW9kZXNbXCJhc21cIl07XG4gICAgfVxuICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIC8vIENsZWFudXAgaWYgbmVjZXNzYXJ5XG4gIH1cblxuICByZWZyZXNoKCkge1xuICAgIGNvbnNvbGUubG9nKFwiUmVmcmVzaGluZyBzeW50YXggaGlnaGxpZ2h0aW5nXCIpO1xuICAgIHRoaXMuYXBwLndvcmtzcGFjZS5pdGVyYXRlQ29kZU1pcnJvcnMoY20gPT4ge1xuICAgICAgY20uc2V0T3B0aW9uKFwibW9kZVwiLCBjbS5nZXRPcHRpb24oXCJtb2RlXCIpKTtcbiAgICB9KTtcbiAgfVxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBdUI7QUFFdkIsSUFBcUIsaUJBQXJCLGNBQTRDLHVCQUFPO0FBQUEsRUFBbkQ7QUFBQTtBQU9FLHVCQUFjLE1BQU07QUFFbEIsY0FBUSxJQUFJLDhDQUE4QztBQUMxRCxXQUFLLElBQUksVUFBVSxJQUFJLGdCQUFnQixLQUFLLFdBQVc7QUFDdkQsVUFBSSxPQUFPLGVBQWUsZUFBZSxXQUFXLGtCQUFrQjtBQUNwRSxnQkFBUSxJQUFJLHVEQUF1RDtBQUNuRSxhQUFLLGNBQWM7QUFDbkIsYUFBSyxRQUFRO0FBQUEsTUFDZixPQUFPO0FBQ0wsY0FBTSxnQkFBZ0IsWUFBWSxNQUFNO0FBQ3RDLGNBQUksT0FBTyxlQUFlLGVBQWUsV0FBVyxrQkFBa0I7QUFDcEUsb0JBQVEsSUFBSSx1REFBdUQ7QUFDbkUsaUJBQUssY0FBYztBQUNuQixpQkFBSyxRQUFRO0FBQ2IsaUJBQUssSUFBSSxVQUFVLFdBQVcsWUFBWTtBQUMxQywwQkFBYyxhQUFhO0FBQzNCLGlCQUFLLGVBQWU7QUFBQSxVQUN0QjtBQUFBLFFBQ0YsR0FBRyxHQUFHO0FBQUEsTUFDUjtBQUFBLElBQ0Y7QUFBQTtBQUFBLEVBMUJBLE1BQU0sU0FBUztBQUViLFlBQVEsSUFBSSwrQ0FBK0M7QUFDM0QsU0FBSyxJQUFJLFVBQVUsY0FBYyxLQUFLLFlBQVksSUFBSSxLQUFLLElBQUksVUFBVSxHQUFHLGdCQUFnQixLQUFLLFdBQVc7QUFBQSxFQUM5RztBQUFBLEVBd0JRLGdCQUFnQjtBQUN0QixVQUFNLFVBQVU7QUFBQSxNQUNkLE9BQU87QUFBQSxRQUNMLEVBQUUsT0FBTyxPQUFPLE9BQU8sVUFBVTtBQUFBLFFBQ2pDLEVBQUUsT0FBTyxpTEFBaUwsT0FBTyxVQUFVO0FBQUEsUUFDM00sRUFBRSxPQUFPLDZMQUE2TCxPQUFPLFdBQVc7QUFBQSxRQUN4TixFQUFFLE9BQU8scURBQXFELE9BQU8sU0FBUztBQUFBLFFBQzlFLEVBQUUsT0FBTyx3QkFBd0IsT0FBTyxXQUFXO0FBQUEsUUFDbkQsRUFBRSxPQUFPLHlKQUF5SixPQUFPLFlBQVk7QUFBQSxRQUNyTCxFQUFFLE9BQU8sS0FBSyxPQUFPLFlBQVk7QUFBQSxRQUNqQyxFQUFFLE9BQU8sK0JBQStCLE9BQU8sUUFBUTtBQUFBLFFBQ3ZELEVBQUUsT0FBTyxnRUFBZ0UsT0FBTyxjQUFjO0FBQUEsUUFDOUYsRUFBRSxPQUFPLG1EQUFtRCxPQUFPLFVBQVU7QUFBQSxNQUMvRTtBQUFBLElBQ0Y7QUFFQSxlQUFXLGlCQUFpQixPQUFPLE9BQU87QUFBQSxFQUM1QztBQUFBLEVBRUEsV0FBVztBQUNULFFBQUksV0FBVyxNQUFNLGVBQWUsS0FBSyxHQUFHO0FBQzFDLGFBQU8sV0FBVyxNQUFNLEtBQUs7QUFBQSxJQUMvQjtBQUNBLFNBQUssUUFBUTtBQUFBLEVBRWY7QUFBQSxFQUVBLFVBQVU7QUFDUixZQUFRLElBQUksZ0NBQWdDO0FBQzVDLFNBQUssSUFBSSxVQUFVLG1CQUFtQixRQUFNO0FBQzFDLFNBQUcsVUFBVSxRQUFRLEdBQUcsVUFBVSxNQUFNLENBQUM7QUFBQSxJQUMzQyxDQUFDO0FBQUEsRUFDSDtBQUNGOyIsCiAgIm5hbWVzIjogW10KfQo=
