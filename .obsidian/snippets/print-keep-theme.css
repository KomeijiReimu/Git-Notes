@media print {

    /* 导出 PDF 会被强制变成 theme-light，所以我们在打印时把深色变量“写回去” */
    body.theme-light {
        color-scheme: dark;
        --text-normal: hsl(var(--accent-h), 15%, 85%);
        --text-muted: hsl(var(--accent-h), 12%, 75%);
        --text-faint: hsl(var(--accent-h), 9%, 50%);
        --highlight-mix-blend-mode: lighten;
        --mono-rgb-0: 0, 0, 0;
        --mono-rgb-100: 255, 255, 255;
        --color-red-rgb: 255, 120, 129;
        --color-red: rgb(var(--color-red-rgb));
        --color-green-rgb: 124, 211, 124;
        --color-green: rgb(var(--color-green-rgb));
        --color-orange-rgb: 251, 187, 131;
        --color-orange: rgb(var(--color-orange-rgb));
        --color-yellow-rgb: 255, 232, 139;
        --color-yellow: rgb(var(--color-yellow-rgb));
        --color-cyan-rgb: 134, 223, 226;
        --color-cyan: rgb(var(--color-cyan-rgb));
        --color-blue-rgb: 137, 189, 244;
        --color-blue: rgb(var(--color-blue-rgb));
        --color-purple-rgb: 203, 158, 255;
        --color-purple: rgb(var(--color-purple-rgb));
        --color-pink-rgb: 242, 182, 222;
        --color-pink: rgb(var(--color-pink-rgb));
        --color-base-00: #1e1e1e;
        --color-base-10: #242424;
        --color-base-15: #252525;
        --color-base-20: #262626;
        --color-base-25: #2a2a2a;
        --color-base-30: #363636;
        --color-base-35: #3F3F3F;
        --color-base-40: #555;
        --color-base-50: #666;
        --color-base-60: #999;
        --color-base-70: #bababa;
        --color-base-100: #dadada;
        --accent-h: var(--accent-dark-h);
        --accent-s: var(--accent-dark-s);
        --accent-l: var(--accent-dark-l);
        --accent-dark-h: 232;
        --accent-dark-s: 40%;
        --accent-dark-l: 60%;
        --color-accent-hsl: var(--color-accent-hsl-dark);
        --color-accent: var(--color-accent-dark);
        --color-accent-1: var(--color-accent-1-dark);
        --color-accent-2: var(--color-accent-2-dark);
        --color-accent-3: var(--color-accent-3-dark);
        --color-accent-hsl-dark: var(--accent-h),
            var(--accent-s),
            var(--accent-l);
        --color-accent-dark: hsl(var(--accent-h), var(--accent-s), var(--accent-l));
        --color-accent-1-dark: hsl(calc(var(--accent-h) - 3), calc(var(--accent-s) * 1.02), calc(var(--accent-l) * 1.15));
        --color-accent-2-dark: hsl(calc(var(--accent-h) - 5), calc(var(--accent-s) * 1.05), calc(var(--accent-l) * 1.29));
        --color-accent-3-dark: hsla(var(--accent-h), calc(0.4*var(--accent-s)), calc(0.9*var(--accent-l)));
        --background-modifier-border-muted: hsla(var(--accent-h), calc(0.4*var(--accent-s)), calc(0.9*var(--accent-l)), 0.1);
        --background-modifier-border: hsla(var(--accent-h), calc(0.4*var(--accent-s)), calc(0.9*var(--accent-l)), 0.2);
        --background-modifier-border-hover: hsla(var(--accent-h), calc(0.4*var(--accent-s)), calc(0.9*var(--accent-l)), 0.25);
        --background-modifier-border-focus: hsla(var(--accent-h), calc(0.4*var(--accent-s)), calc(0.9*var(--accent-l)), 0.3);
        --background-primary: hsl(var(--accent-h), calc(var(--accent-s) / 5), calc(1.25*var(--accent-l) / 4.5));
        --background-primary-alt: hsl(var(--accent-h), calc(var(--accent-s) / 5), calc(1.25*var(--accent-l) / 3.9));
        --background-secondary: hsl(var(--accent-h), calc(var(--accent-s) / 5), calc(1.25*var(--accent-l) / 4.9));
        --background-secondary-alt: hsl(var(--accent-h),
                calc(var(--accent-s) / 5.4),
                calc(1.25*var(--accent-l) / 3));
        --background-tertiary: hsl(var(--accent-h),
                calc(var(--accent-s) / 5.4),
                calc(1.25*var(--accent-l) / 3.6));
        --workspace-background-translucent: hsla(var(--accent-h),
                calc(var(--accent-s) / 5.4),
                calc(1.25*var(--accent-l) / 3.6), 0.6);
        --background-modifier-hover: hsla(var(--accent-h), 12%, 40%, 0.25);
        --background-modifier-active-hover: hsla(var(--interactive-accent-hsl), 0.15);
        --background-modifier-box-shadow: rgba(0, 0, 0, 0.3);
        --background-modifier-cover: rgba(10, 10, 10, 0.4);
        --background-modifier-form-field: transparent;
        --search-result-background: transparent;
        --text-highlight-bg: rgba(255, 208, 0, 0.4);
        --text-highlight-bg-active: rgba(255, 128, 0, 0.4);
        --text-selection: hsla(var(--interactive-accent-hsl), 0.4);
        --shadow-s: 0px 1px 2px rgba(0, 0, 0, 0.121),
            0px 3.4px 6.7px rgba(0, 0, 0, 0.179),
            0px 15px 30px rgba(0, 0, 0, 0.3),
            0 -1px 0 0 var(--background-modifier-border-focus);
        --shadow-l: 0px 1.8px 7.3px rgba(0, 0, 0, 0.071),
            0px 6.3px 24.7px rgba(0, 0, 0, 0.112),
            0px 30px 90px rgba(0, 0, 0, 0.2),
            0 -1px 0 0 var(--background-modifier-border-focus);

        /* 让主题内“light”变量在打印时也套用暗色值，避免代码块、表格等退化 */
        --background-alt-light: var(--background-alt-dark);
        --inline-code-background-light: var(--inline-code-background-dark);
        --code-background-light: var(--code-background-dark);
        --code-border-light: var(--code-border-dark);
        --code-background: var(--code-background-dark);
        --code-border: var(--code-border-dark);
        --blockquote-background-light: var(--blockquote-background-dark);
        --table-header-background-light: var(--table-header-background-dark);

        /* 打印时强制使用 one dark 调色板，并让注释同字符串色（亮绿） */
        --code-background-light: #282C34;
        --code-background-dark: #282C34;
        --code-border-light: none;
        --code-border-dark: none;
        --code-normal: #ABB2BF;
        --code-comment: #98C379;
        --code-function: #E5C07B;
        --code-important: #D19A66;
        --code-keyword: #E06C75;
        --code-operator: #BE5046;
        --code-property: #56B6C2;
        --code-punctuation: #ABB2BF;
        --code-string: #98C379;
        --code-tag: #BE5046;
        --code-value: #C678DD;

    }

    /* 代码块/行内代码：强制使用主题色（Prism/CodeMirror） */
    .print pre[class*="language-"],
    .print code[class*="language-"] {
        color: var(--code-normal) !important;
    }

    .print pre[class*="language-"] .token.comment,
    .print pre[class*="language-"] .token.prolog,
    .print pre[class*="language-"] .token.doctype,
    .print pre[class*="language-"] .token.cdata,
    .print code[class*="language-"] .token.comment,
    .print code[class*="language-"] .token.prolog,
    .print code[class*="language-"] .token.doctype,
    .print code[class*="language-"] .token.cdata,
    .print .cm-s-obsidian span.cm-comment {
        color: var(--code-comment) !important;
    }

    .print pre[class*="language-"] .token.punctuation,
    .print code[class*="language-"] .token.punctuation,
    .print .cm-s-obsidian span.cm-punctuation {
        color: var(--code-punctuation) !important;
    }

    .print pre[class*="language-"] .token.property,
    .print pre[class*="language-"] .token.tag,
    .print pre[class*="language-"] .token.constant,
    .print pre[class*="language-"] .token.symbol,
    .print pre[class*="language-"] .token.deleted,
    .print code[class*="language-"] .token.property,
    .print code[class*="language-"] .token.tag,
    .print code[class*="language-"] .token.constant,
    .print code[class*="language-"] .token.symbol,
    .print code[class*="language-"] .token.deleted,
    .print .cm-s-obsidian span.cm-attribute,
    .print .cm-s-obsidian span.cm-tag {
        color: var(--code-tag) !important;
    }

    .print pre[class*="language-"] .token.boolean,
    .print pre[class*="language-"] .token.number,
    .print pre[class*="language-"] .token.selector,
    .print pre[class*="language-"] .token.attr-name,
    .print pre[class*="language-"] .token.char,
    .print pre[class*="language-"] .token.builtin,
    .print pre[class*="language-"] .token.inserted,
    .print code[class*="language-"] .token.boolean,
    .print code[class*="language-"] .token.number,
    .print code[class*="language-"] .token.selector,
    .print code[class*="language-"] .token.attr-name,
    .print code[class*="language-"] .token.char,
    .print code[class*="language-"] .token.builtin,
    .print code[class*="language-"] .token.inserted,
    .print .cm-s-obsidian span.cm-number,
    .print .cm-s-obsidian span.cm-atom {
        color: var(--code-value) !important;
    }

    .print pre[class*="language-"] .token.keyword,
    .print code[class*="language-"] .token.keyword,
    .print .cm-s-obsidian span.cm-keyword {
        color: var(--code-keyword) !important;
    }

    .print pre[class*="language-"] .token.operator,
    .print code[class*="language-"] .token.operator,
    .print .cm-s-obsidian span.cm-operator {
        color: var(--code-operator) !important;
    }

    .print pre[class*="language-"] .token.string,
    .print pre[class*="language-"] .token.attr-value,
    .print pre[class*="language-"] .token.regex,
    .print pre[class*="language-"] .token.variable,
    .print pre[class*="language-"] .token.url,
    .print code[class*="language-"] .token.string,
    .print code[class*="language-"] .token.attr-value,
    .print code[class*="language-"] .token.regex,
    .print code[class*="language-"] .token.variable,
    .print code[class*="language-"] .token.url,
    .print .cm-s-obsidian span.cm-string {
        color: var(--code-string) !important;
    }

    .print pre[class*="language-"] .token.function,
    .print code[class*="language-"] .token.function,
    .print .cm-s-obsidian span.cm-variable,
    .print .cm-s-obsidian span.cm-property {
        color: var(--code-function) !important;
    }

    .print pre[class*="language-"] .token.important,
    .print code[class*="language-"] .token.important {
        color: var(--code-important) !important;
        font-weight: bold;
    }

    /* 渲染时强制使用暗色的行内代码底色 */
    .print :not(pre)>code,
    .print .cm-s-obsidian span.cm-inline-code {
        background: var(--inline-code-background-dark);
    }

    .print .cm-s-obsidian span.cm-inline-code span.cm-inline-code.cm-hmd-indented-code {
        background: unset;
    }

    /* Callout 在打印时保持暗色透明底 */
    .print .callout:is([data-callout-metadata*="style-1"], [data-callout*=style-1]),
    .print .callout-style-1,
    .print .callout:is([data-callout-metadata*="style-2"], [data-callout*=style-2]),
    .print .callout-style-2,
    .print .callout:is([data-callout-metadata*="style-4"], [data-callout*=style-4]),
    .print .callout-style-4 {
        --callout-content-background: #00000040;
    }

    /* 允许打印背景/颜色 */
    body,
    .print,
    .print * {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }

    /* 用主题变量给打印页上色 */
    .print .markdown-preview-view {
        background: var(--background-primary) !important;
        color: var(--text-normal) !important;
        box-shadow: 0 0 0 100vh var(--background-primary);
    }

    @page {
        margin: 0;
    }
}
